<div *ngIf="isLoading" class="spinner">
  <img src= "assets/spinner.gif">
</div>

<div *ngIf="reportsData && !isLoading" style="height: 100%;">
  <div style="height: 10%"> <!--; padding: 10px;-->
    <button mat-icon-button color="primary" (click)="openNewSheet(option)" *ngFor="let option of insertOptions"
      [ngSwitch]="option.id">
      <mat-icon *ngSwitchCase="'chart'">insert_chart</mat-icon>
      <mat-icon *ngSwitchCase="'pivot'">table_chart</mat-icon>
    </button>
    <button class="float-right" mat-flat-button color="primary" (click)="saveReport()">Save</button>
  </div>
  <mat-tab-group headerPosition="below" style="height: 90%;">
    <mat-tab *ngFor="let sheet of reportsData.pages; let i = index" style="height: 100%;">
      <ng-template mat-tab-label>
        <app-inline-edit autofocus [item]="sheet.label" [itemID]="i" [customClass]="'text-body text-center'"
        (onSave)="renameSheet($event, i)"></app-inline-edit>
        <button mat-icon-button id="delete" (click)="deleteSheet(i)" *ngIf="!!i">
          <mat-icon>clear</mat-icon>
        </button>
      </ng-template>

      <div style="height: 80%;" [ngSwitch]="sheet.type">
        <ng-template matTabContent style="height: 100%;">
          <app-table-cont [tableData]="sheet.data" [columns]="getKeys(sheet.data[0])" style="height: 100%;"
            *ngSwitchCase="'table'">
          </app-table-cont>
          <app-chart-selector (update)="onUpdate($event, i)" [view]="'sidenav'" [chartInputData]="sheet.data" style="height: 100%;"*ngSwitchCase="'chart'"></app-chart-selector>
          <app-pivot (update)="onUpdate($event, i)" [pivotData]="sheet.data" style="height: 100%;" *ngSwitchCase="'pivot'"></app-pivot>
        </ng-template>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>