<div *ngIf="isLoading" class="spinner">
  <img src= "assets/spinner.gif">
</div>

<div *ngIf="reportsData && !isLoading" style="height: 100%;">
  <div style="height: 10%; padding: 10px;">
    <button mat-icon-button color="primary" (click)="openNewSheet(option)" *ngFor="let option of insertOptions"
      [ngSwitch]="option.id">
      <mat-icon *ngSwitchCase="'chart'">insert_chart</mat-icon>
      <mat-icon *ngSwitchCase="'pivot'">table_chart</mat-icon>
    </button>
    <button class="float-right" mat-flat-button color="primary" (click)="saveReport()">Save</button>
    <button type="button" class="btn print float-right" (click)="exportByExcel()">            
      <svg viewBox="0 0 24 24">
        <path fill="#ffffff" d="M19.92,12.08L12,20L4.08,12.08L5.5,10.67L11,16.17V2H13V16.17L18.5,10.66L19.92,12.08M12,20H2V22H22V20H12Z" />
      </svg>
    </button>
  </div>
  <mat-tab-group headerPosition="below" style="height: 90%;">
    <mat-tab *ngFor="let sheet of reportsData.pages; let i = index; let isFirst = first;" style="height: 100%;">
      <ng-template mat-tab-label>
        <span>{{sheet.label}}</span>
        <button mat-icon-button id="delete" (click)="deleteSheet(i)" *ngIf="!isFirst">
          <mat-icon>clear</mat-icon>
        </button>
      </ng-template>

      <div style="height: 80%;" [ngSwitch]="sheet.type">
        <ng-template matTabContent style="height: 100%;">
          <app-table-cont [tableData]="sheet.data" [columns]="getKeys(sheet.data[0])" style="height: 100%;"
            *ngSwitchCase="'table'">
          </app-table-cont>
          <app-chart [chartData]="sheet.data" style="height: 100%;" *ngSwitchCase="'chart'"></app-chart>
          <app-pivot [pivotData]="sheet.data" style="height: 100%;" *ngSwitchCase="'pivot'"></app-pivot>
        </ng-template>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>