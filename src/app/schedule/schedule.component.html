<!-- <form class="needs-validation"> -->
    <div class="modal fade" id="scheduleModal" tabindex="-1" role="dialog" aria-labelledby="scheduleModal"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="scheduleModal">Report Scheduler</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="refreshScheduleData()" >
              <!-- (click)="refreshScheduleData()" -->
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
  
        <div class="modal-body">
          <div class="row ">
            <label for="reportName" class="col-xs-5">Report Name:</label>
            <div class="col-xs-7">
              <input name="reportName" id="reportName" [(ngModel)]="scheduleData.report_name" class="form-control"
                type="text" style="width: 100%" readonly="all" />
              <!-- <input name="reportName" id="reportName" class="input" type="text" style="width: 100%"/> -->
            </div>
          </div>
  
          <div class="row ">
            <label for="reportFormat" class="col-xs-5">Report's request id</label>
            <div class="col-xs-7">
              <!-- <select [(ngModel)]="scheduleData.request_id" id="reportFormat" class="form-control" name="reportFormat"
                style="background-color: #FFF;width: 100%;height: 100%;">
                <option *ngFor="let id of requestIds" [value]="id">{{id}}</option>
              </select> -->
              <input name="reportRequestId" id="reportRequestId" [(ngModel)]="scheduleData.request_id" class="form-control"
                type="text" style="width: 100%" readonly="all" />
                <!-- <input name="reportRequestId" id="reportequestId" [(ngModel)]="requestReport" class="form-control"
                type="text" style="width: 100%" readonly="all" /> -->
            </div>
          </div>
  
          <div class="row ">
            <label for="recurringReport" class="col-xs-5">Recurring report<span class="span-color">*</span></label>
            <div class="col-xs-7">
              <div class="radio-inline">
                <input type="radio" name="recurringReport" (click)="setRecurringFlag(true)"
                [checked]="scheduleData.recurring_flag">Yes
              </div>
              <!-- To show when there is 'NO' value selected -->
              <div class="radio-inline" *ngIf="showRadio">
                <input type="radio" name="recurringReport" (click)="setRecurringFlag(false)"
                [checked]="!scheduleData.recurring_flag">No
              </div>
              <!-- To show when there is 'NO' value not-selected -->
              <div class="radio-inline" *ngIf="!showRadio">
                  <input type="radio" name="recurringReport" (click)="setRecurringFlag(false)">No
                </div>
            </div>
          </div>
  
          <div class="row" *ngIf="scheduleData.recurring_flag">
            <label for="recurringReportFrequency" class="col-xs-5">(set frequency)<span class="span-color">*</span></label>
            <div class="col-xs-7">
              <select class="form-control form-control-lg" name="recurringReportFrequency" [(ngModel)]="scheduleData.recurrence_pattern"
                (click)="setCollapse(scheduleData.recurrence_pattern)">
                <option *ngFor="let format of recurrencePattern" [value]="format.value">{{format.display}}</option>
              </select>
            </div>
          </div>
  
          <div class="row ">
            <label for="scheduleDate" class="col-xs-5">Schedule Date<span class="span-color">*</span></label>
            <div class="col-xs-7" (click)="setSendingDates()">
              <!-- NOT NEEDED -->
              <!-- <app-multi-dates-picker [(ngModel)]="scheduleData.scheduleDate"></app-multi-dates-picker> -->
              <!-- <app-multi-dates-picker></app-multi-dates-picker> -->
              <!-- <input type="text" ngbDatepicker [minDate]="{year:2019,month:7,day:30}" class="form-control"> -->
              <!-- ORIGINAL -->
              <div class="form-group">
                <div class='input-group date '>
                    <input type='text' class="form-control pre-height" [(ngModel)]="values" title='{{values}}' readonly="all"/>
                    <span class="input-group-addon" (click)="hideCalendar()">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                </div>
            </div>
            <ngb-multi-date-picker (click)="checkingDates()" [datesSelected]="datesSelected" (datesSelectedChange)="change($event)" [hidden]="calendarHide">
            </ngb-multi-date-picker>
            </div>
          </div>
  
          <div class="row ">
            <label for="scheduleTime" class="col-xs-5">Schedule Time<span class="span-color">*</span></label>
            <div class="col-xs-7">
              <input name="scheduleTime" id="scheduleTime" [(ngModel)]="scheduleData.schedule_for_time"
                class="form-control" type="time" style="width: 100%" />
              <!-- <input name="scheduleTime" id="scheduleTime" class="input" type="time" style="width: 100%"/> -->
            </div>
          </div>
  
          <div class="row ">
            <label for="reportFormat" class="col-xs-5">Report format<span class="span-color">*</span></label>
            <div class="col-xs-7">
              <select [(ngModel)]="scheduleData.export_format" id="reportFormat" class="form-control" name="reportFormat"
                style="background-color: #FFF;width: 100%;height: 100%;">
                <option *ngFor="let format of reportFormats" [value]="format.value">{{format.display}}</option>
              </select>
            </div>
          </div>
  
          <div class="row ">
            <label for="recurringReport" class="col-xs-5 col-form-label">Send notifications<span class="span-color">*</span></label>
            <div class="col-xs-7">
              <div class="radio-inline">
                <input type="radio" id="notifications" name="notifications" (click)="setNotificationValue(true)"
                  [checked]="scheduleData.notification_flag">Yes
              </div>
              <!-- To show when NO value selected -->
              <div class="radio-inline" *ngIf="showNotification">
                  <input type="radio" id="notifications" name="notifications" (click)="setNotificationValue(false)"
                  [checked]="!scheduleData.notification_flag">No
                </div>
                <!-- To show when there is NO value not-selected -->
                <div class="radio-inline" *ngIf="!showNotification">
                    <input type="radio" id="notifications" name="notifications" (click)="setNotificationValue(false)">No
                </div>
            </div>
          </div>
  
  
          <div class="row">
            <label for="email-address" class="col-xs-5 col-form-label">Email Address(es)<span class="span-color">*</span></label>
            <div class=" col-xs-7">
              <!-- <input maxlength="50" (keyup.enter)="addTags()" class="tags-box form-control form-control-lg" [(ngModel)]="multipleAddresses" appValidator/> -->
              <input class="form-control form-control-lg" matInput [matChipInputFor]="chipList" [matChipInputSeparatorKeyCodes]="separatorKeysCodes" (matChipInputTokenEnd)="add($event)"
              style="border: 1px solid #afafb5;border-radius:5px;width: 100%;height: 30px;margin-top: 9px;margin-left: 0px;outline: none;padding:12px"
              [matAutocomplete]="shareSuggestion" [formControl]="fruitCtrl" name="email" type="email" pattern="[a-zA-Z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,3}$" />
            <!-- </div> -->
            </div>
            <div *ngIf="loading" class="spinner-border" role="status">
              <span class="sr-only">Loading...</span>
            </div>
            <mat-autocomplete #shareSuggestion="matAutocomplete" (optionSelected)="onSelectionChanged($event)">
              <mat-option *ngFor="let opt of autoUserList" [value]="opt" >
                {{opt}}
              </mat-option>
            </mat-autocomplete>
            <mat-error *ngIf="isDuplicate">Already selected!</mat-error>
            <div *ngIf="fruitCtrl.errors?.pattern">
              <p style="color: red;">Email is invalid</p>
            </div>
            <div class="chips">
              <mat-chip-list #chipList>
                <mat-chip *ngFor="let email of emails" [selectable]="selectable" [removable]="removable"
                  (removed)="remove(email)" [(ngModel)]="scheduleData.multiple_addresses">
                  {{email}}
                  <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                </mat-chip>
              </mat-chip-list>
            </div>
          </div>
  
          <!-- <div class="row chips">  
            <div class="row" style="overflow-x: auto;max-height: 162px">
            <span class="tags-style" *ngFor="let tags of exportTags; index as i"> {{tags}} 
              <div (click)="removeTags(i)" class="cross-button">&times;</div>
            </span>
          </div>
            <span class="tags-style-new" *ngFor="let newtags of scheduleData['multiple_addresses']; index as i"> {{newtags}} 
              <div (click)="removeNewTags(i)" class="cross-button">&times;</div>
            </span>
          </div> -->
  
          <div class="row">
            <label for="delivery-method" class="col-xs-5">Delivery Method<span class="span-color">*</span></label>
            <div class=" col-xs-7">
              <select name="deliveryMethod" id="deliveryMethod" name="deliveryMethod"
                [(ngModel)]="scheduleData.sharing_mode" (change)="changeDeliveryMethod(scheduleData.sharing_mode)"
                class="form-control form-control-lg">
                <option [hidden]="!hideFtp" *ngFor="let format of sharingModes" [value]="format.value">{{format.display}}</option>
                <option [hidden]="hideFtp" *ngFor="let format of sharingModesNonAdmins" [value]="format.value">{{format.display}}</option>
              </select>
            </div>
          </div>
  
          <!-------------------------------------FTP option selector------------------------------------------------------>
  
          <div id="FTP" [hidden]="isFtpHidden">
            <div class="row">
              <label for="ftp-address" class="col-xs-5 col-form-label">FTP Address<span class="span-color">*</span></label>
              <div class=" col-xs-7">
                  <input name="ftpAddress" id="ftpAddress" class="form-control form-control-lg"
                  [(ngModel)]="scheduleData.ftp_address">
              </div>
            </div>
          </div>
  
          <div id="FTP" [hidden]="isFtpHidden">
            <div class="row">
              <label for="ftp-port" class="col-xs-5">FTP Port<span class="span-color">*</span></label>
              <div class=" col-xs-7">
                  <input name="ftpPort" id="ftpPort" class="form-control form-control-lg"
                  [(ngModel)]="scheduleData.ftp_port" aria-placeholder=" ">
              </div>
            </div>
          </div>
  
          <div id="FTP" [hidden]="isFtpHidden">
            <div class="row">
              <label for="ftp-folder-path" class="col-xs-5">FTP folder path:
                <span>
                <button class="info-bubble" data-toggle = "tooltip" title="If the folder path is not specified,files will be pushed into the default folder">
                  <svg viewBox="0 0 24 24" >
                    <path fill="#000000" d="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z" />
                  </svg>
                </button>  
              </span>
              </label>
              <div class=" col-xs-7">
                <input type="text" [(ngModel)]="scheduleData.ftp_folder_path" class="form-control form-control-lg"
                  placeholder="Optional">
              </div>
            </div>
          </div>
  
          <div id="FTP" [hidden]="isFtpHidden">
            <div class="row">
              <label for="ftp-user-name" class="col-xs-5">FTP user name<span class="span-color">*</span></label>
              <div class=" col-xs-7">
                <input type="text" [(ngModel)]="scheduleData.ftp_user_name" class="form-control form-control-lg">
              </div>
            </div>
          </div>
  
          <div id="FTP" [hidden]="isFtpHidden">
            <div class="row">
              <label for="ftp-pasword" class="col-xs-5">FTP password<span class="span-color">*</span></label>
              <div class=" col-xs-7">
                <input type="text" [(ngModel)]="scheduleData.ftp_password" class="form-control form-control-lg">
              </div>
            </div>
          </div>
  
          <div class="row"> 
            <label class="col-xs-5">Add Description<span class="span-color">*</span></label>
            <div class="col-xs-7">
              <!-- <textarea class="form-control mb-4 PADD5PX" id="description" row="1" [(ngModel)]="scheduleData.description" 
                (keydown)="autoSize($event.target)" (input)="transformDescription()"></textarea> -->
              <div contenteditable="true" id ="description" class="description form-control mb-4 PADD5PX" 
              (keydown)="autoSize($event.target)" (input)="transformDescription()" name="description" [(ngModel)]="scheduleData.description"></div>
            </div>
          </div>
  
          <div class="row">
            <label class="col-xs-5">Add Attachment</label>
            <div class="col-xs-7 pl-2">
            <input #imageInput type="file" class="sideButtons" style="display: none;" accept=".pdf, .doc, .docx"
              id="valueInput" (change)="uploadPdf($event)" #pdf>
            <button (click)="imageInput.click()"
              style="margin-top:3px;border: none;background-color:transparent;outline: none;" title="Upload pdf">
              <svg style="width:20px;height:20px" viewBox="0 0 24 24">
                <path fill="#000000"
                  d="M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V4A2,2 0 0,1 6,2M10.1,11.4C10.08,11.44 9.81,13.16 8,16.09C8,16.09 4.5,17.91 5.33,19.27C6,20.35 7.65,19.23 9.07,16.59C9.07,16.59 10.89,15.95 13.31,15.77C13.31,15.77 17.17,17.5 17.7,15.66C18.22,13.8 14.64,14.22 14,14.41C14,14.41 12,13.06 11.5,11.2C11.5,11.2 12.64,7.25 10.89,7.3C9.14,7.35 9.8,10.43 10.1,11.4M10.91,12.44C10.94,12.45 11.38,13.65 12.8,14.9C12.8,14.9 10.47,15.36 9.41,15.8C9.41,15.8 10.41,14.07 10.91,12.44M14.84,15.16C15.42,15 17.17,15.31 17.1,15.64C17.04,15.97 14.84,15.16 14.84,15.16M7.77,17C7.24,18.24 6.33,19 6.1,19C5.87,19 6.8,17.4 7.77,17M10.91,10.07C10.91,10 10.55,7.87 10.91,7.92C11.45,8 10.91,10 10.91,10.07Z" />
              </svg>
            </button>
            <span *ngIf="fileUpload">{{fileName}}</span>
            <button *ngIf="fileUpload" style="margin-left: 5px;border-radius: 5px;" (click)="reset()">Reset</button>
          </div>
          </div>
  
          <div class="row">
            <label class="col-xs-5">Add Signature<span class="span-color">*</span></label>
            <div class="col-xs-7 pl-2 pr-0">
            <div class="col-xs-10 pl-3 pr-0">
            <select class="form-control form-control-lg w-100" (change)="select()" [(ngModel)]="scheduleData.signature_html"
              placeholder="select or create">
              <option style="display: none;"></option>
              <option *ngFor="let sign of signatures" [value]="sign.signature_html">
                {{sign.signature_name}}
              </option>
            </select>
            </div>
            <div class="col-xs-2 pl-0">
            <button #editSign id="editSign" data-toggle="modal" [disabled]="!signSelected" data-target="#signature"
              data-backdrop="static" data-keyboard="false"
              style="margin-top:3px;border: none;background-color:transparent;outline: none;" title="Edit Signature">
              <svg style="width:20px;height:20px;" viewBox="0 0 24 24">
                <path [ngStyle]="{'fill' : signSelected ? 'black' : 'gray'}"
                  d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
              </svg>
            </button>
          </div>
          </div>
        </div>
  
        </div>
  
        <!----------------------------------Modal footer------------------------------------------------>
  
        <div class="modal-footer mt-0 mr-4">
          <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="refreshScheduleData()">Cancel</button>
          <!-- (click)="refreshScheduleData()" -->
          <button type="button" class="btn btn-success button-uniform"
            (click)="apply();setMultipleAddressListValues()">Apply</button>
        </div>
  
      </div>
    </div>
  </div>
  <!-- </form> -->