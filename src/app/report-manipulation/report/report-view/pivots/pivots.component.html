<div class="modal-container">
  <div class="modal-header">  
    Pivots Table
    <mat-icon style="cursor:pointer;" (click)="closeDailog();">close</mat-icon>
  </div>
  <div class="loader" *ngIf="showLoader">
    <div >Loading......</div>
  </div>
  <div class="modal-body" style="padding:10px;" *ngIf="!enablePreview && !showLoader">
    
    <div class="select-container" >
        <mat-form-field>
            <mat-label>Row label</mat-label>
            <mat-select multiple (selectionChange)="rowFieldSelected($event)" [(ngModel)]="selectedRow"
                        [title]="selectedRow.toString() | spaceFormater">
              <mat-option [value]="column.columnName" *ngFor="let column of columnDetails">
                {{ column.columnName | spaceFormater }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <div class="selected-conatiner" *ngIf="this.selected.data.rowField.length > 0">
            <div class="row-label-selected" *ngFor="let col1 of this.selected.data.rowField">{{ col1 | spaceFormater }}</div>
          </div>
          <mat-form-field style="margin-top: 8px;">
            <mat-label>Column</mat-label>
            <mat-select multiple [(ngModel)]="selected.data.column">
              <mat-option [value]="column.columnName" *ngFor="let column of columnDetails">
                {{ column.columnName | spaceFormater }}
              </mat-option>
            </mat-select>
          </mat-form-field>
    </div>
    <div class="select-container" style="width: 58%">
        <mat-form-field style="display: block;">
            <mat-label>Value</mat-label>
            <mat-select multiple (selectionChange)="dataFieldSelected($event)" [(ngModel)]="selectedValue"
                        [title]="selectedValue.toString() | spaceFormater">
              <mat-option [value]="column.columnName" *ngFor="let column of columnDetails">
                {{ column.columnName | spaceFormater }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <div class="selected-conatiner" *ngIf="this.selected.data.dataField.length > 0">
              <div class="row-column-selected" *ngFor="let col2 of selected.data.dataField">
                  <mat-form-field>
                    <mat-label>function</mat-label>
                    <mat-select [(ngModel)]="col2.function">
                        <mat-option *ngFor="let func of function"
                        [value]="func">{{ func }}</mat-option>
                    </mat-select>
                    </mat-form-field>&nbsp;
                    <span>(of)</span>&nbsp;
                    <span style="font-size: 16px;font-weight: 600;">{{ col2.value | spaceFormater }}</span>
              </div>
              
          </div>
          <mat-form-field appearance="outline" style="width: 400px;" style="margin-top: 8px;">
            <mat-label>New sheet name</mat-label>
            <input matInput type="text" [(ngModel)]="selected.tab_name" inputNameValidator maxlength="20" required>
            <mat-hint *ngIf="sheetNameExists && !isEmpty()" style="color:red">Sheet name already exists!</mat-hint>
            <mat-hint *ngIf="isEmpty()" style="color:red">Please enter the valid sheet name!</mat-hint>
          </mat-form-field>
          <mat-form-field appearance="outline" style="width: 400px;" style="margin-top: 8px;margin-left: 30px;">
            <mat-label>Pivot Title</mat-label>
            <input matInput type="text" [(ngModel)]="selected.tab_title" maxlength="50">
            <!-- <mat-hint *ngIf="sheetNameExists" style="color:red">Sheet name already exists!</mat-hint> -->
          </mat-form-field>
    </div>
      
  </div>
  <div class="modal-body" style="padding:10px;" *ngIf="enablePreview">
    <app-pivot-table-wrapper [sheetData]="injectedData.sheetData" [tabData]="selected" [type]="'preview'"
    (isPivotValidEmittor)="pivotResGenerated($event)">
    </app-pivot-table-wrapper>
  </div>
  <div class="modal-footer" *ngIf="!showLoader">
    <span *ngIf="this.checkSheetNameExists()" style="color:red ;position: absolute;left: 25%;">Sheet name already exists!</span>
    <button mat-raised-button style="margin-right: 10px;" (click)="closeDailog();"
    [cssBtn]="'cancel'">Cancel</button>
    <button mat-raised-button style="margin-right: 10px;" (click)="previewPivot()"
    [cssBtn]="'mid'" [disabled]="!formValidPreview()"
    [paramFlag]="!formValidPreview()?true:false">
    {{ enablePreview? 'Edit':'Preview'  }}
    </button>
    <button mat-raised-button (click)="insertTabInSheet();" [disabled]="!formValid() || isEmpty() || this.checkSheetNameExists()"
    [cssBtn]="'ok'" [paramFlag]="!formValid() || isEmpty()?true:false || this.checkSheetNameExists()">Create</button>
  </div>
</div>