<div class="container-fluid overflow-auto mt-4">
  <div class="row">
    <label for="columnToAggregate" class="col-xs-4 col-form-label">Column to aggregate on</label>
    <div class="form-group col-xs-8">
      <select class="form-control form-control-lg" id="columnToAggregate" [(ngModel)]="aggregation.columnToAggregate">
        <option *ngFor="let col of colDisplay">{{col}}</option>
      </select>
    </div>
  </div>

  <div class="row">
    <label for="levelAggregation" class="col-xs-4 col-form-label">Level of aggregation</label>
    <div class="form-group col-xs-8">
      <select class="form-control form-control-lg" id="levelAggregation" [(ngModel)]="aggregation.aggregationLevel">
        <option *ngFor="let col of groupByAndLevels">{{col}}</option>
      </select>
    </div>
  </div>

  <div class="row">
    <label for="functionAggregation" class="col-xs-4 col-form-label">Aggregate function for numerical columns</label>
    <div class="form-group col-xs-8">
      <select class="form-control form-control-lg" id="functionAggregation"
        [(ngModel)]="aggregation.aggregationFunction" (change)="setHide();calculateFormula()">
        <option *ngFor="let col of aggregationFunctions">{{col}}</option>
      </select>
    </div>
  </div>

  <div [hidden]="hide">
    <div class="row" [hidden]="hide">
      <div class="col-xs-6 mb-1"><strong>Aggregation</strong></div>
      <div class="col-xs-6 mb-1"><strong>Column</strong></div>
    </div>
    <div class="row" *ngFor="let item of aggregationsList; index as i; last as isLast">
      <div class="form-group col-xs-6">
        <select class="form-control form-control-lg" [(ngModel)]="aggregation.aggregations[i]"
          (change)="calculateFormula(i)">
          <option *ngFor="let col of aggregations">{{col}}</option>
        </select>
      </div>
      <div class="form-group col-xs-6">
        <select class="form-control form-control-lg" [(ngModel)]="aggregation.columns[i]"
          (change)="calculateFormula(i)">
          <option *ngFor="let col of colDisplay">{{col}}</option>
        </select>
      </div>
      <button type="button" class="btn btn-primary h-50 ml-4 float-left col-xs-1" *ngIf="isLast" (click)="addRow()"
        [disabled]="!aggregation.aggregations[i] || !aggregation.columns[i]">Add</button>
    </div>
  </div>

  <div class="row">
    <label for="formula" class="col-xs-4 col-form-label">Formula</label>
    <div class="col-xs-8">
      <span *ngIf="formula">{{formula}}</span>
      <div *ngIf="aggregation.columnToAggregate">GROUP BY {{aggregation.columnToAggregate}}</div>
    </div>
  </div>

  <div class="container-fluid mt-4">
    <button type="button" class="btn btn-secondary ml-3">Cancel</button>
    <button type="button" class="apply-button btn btn-primary float-right mr-3" (click)="apply()">Apply</button>
  </div>
</div>