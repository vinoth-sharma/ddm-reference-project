<div class="flex-container row tool-body">
  <div *ngIf="reports" class="main-tool-body">
    <div class="wrapper" style="height:100%">
      <div class="row" style="width:100%">
        <div class="col">
          <h3>Reports</h3>
        </div>
        <div class="col">
          <input (input)="globalSearch($event)" placeholder="Insert Keywords/Request Number here " class="form-control">
        </div>
        <!--[(ngModel)]="searchText"-->
        <div class="col">
          <div class="icons">
            <div class="press">
              <!-- <a href="#"><i id="ic" class="material-icons">help_outline</i></a> -->
              <button data-toggle="modal" data-target="#helpModal" style="background-color:white; border:none;padding-right:0px;">
                <a data-toggle="tooltip" title="HELP"><i id="ic" class="material-icons">help_outline</i></a>
              </button>
              <a (click)="xlsxJson()" style="cursor:pointer"><i id="ic" class="material-icons">get_app</i></a>
            </div>
          </div>
        </div>
      </div>

      <div class="tableFixHead">
        <table class="table table-striped table-hover" *ngIf="reports">
          <thead class="thead">
            <tr>
              <th (click)="sort('favorites')">
                <div>
                  <div class="alignLeft">
                    <div>Favourites</div>
                    <!-- <input placeholder="Insert Keywords/Request Number here " class="form-control">                  -->
                    <div *ngIf="!reports['favorites']">&#8593;</div>
                    <div *ngIf="reports['favorites']">&#8595;</div>
                  </div>
                </div>
              </th>
              <th>
                <div>
                  <div class="alignLeft" (click)="sort('ddm_rmp_post_report_id')">
                    <div>Request No.</div>
                    <div *ngIf="!reports['ddm_rmp_post_report_id']">&#8593;</div>
                    <div *ngIf="reports['ddm_rmp_post_report_id']">&#8595;</div>
                  </div>
                  <div>
                    <input (input)="columnSearch($event,'ddm_rmp_post_report_id')" placeholder="Enter Request no" class="form-control">
                  </div>
                </div>
              </th>
              <th>
                <div>
                  <div class="alignLeft" (click)="sort('ddm_rmp_status_date')">
                    <div>Date</div>
                    <div *ngIf="!reports['ddm_rmp_status_date']">&#8593;</div>
                    <div *ngIf="reports['ddm_rmp_status_date']">&#8595;</div>
                  </div>
                  <input (input)="columnSearch($event,'ddm_rmp_status_date')" placeholder="Enter Date" class="form-control">      
                </div>
              </th>
              <th>
                <div>
                  <div class="alignLeft" (click)="sort('title')">
                    <div>Title</div>
                    <div *ngIf="!reports['title']">&#8593;</div>
                    <div *ngIf="reports['title']">&#8595;</div>
                  </div>
                  <div>
                    <input (input)="columnSearch($event,'title')" placeholder="Enter Title" class="form-control">
                  </div>
                </div>
              </th>
              <th>
                <div>
                  <div class="alignLeft" (click)="sort('report_name')">
                    <div>DDM Name</div>
                    <div *ngIf="!reports['report_name']">&#8593;</div>
                    <div *ngIf="reports['report_name']">&#8595;</div>
                  </div>
                  <div>
                    <input (input)="columnSearch($event,'report_name')" placeholder="Enter DDM Name" class="form-control">
                  </div>
                </div>
              </th>
              <th>
                  <div>
                      <div class="alignLeft" (click)="sort('frequency')">
                        <div>Frequency</div>
                        <div *ngIf="!reports['frequency']">&#8593;</div>
                        <div *ngIf="reports['frequency']">&#8595;</div>
                      </div>
                      <div>
                        <input (input)="columnSearch($event,'frequency')" placeholder="Enter Frequency" class="form-control">
                      </div>
                    </div>
              </th>
              <th *ngFor="let weekDay of weekDays" (click)="sort(weekDay + 'Frequency')">
                <div style="width: 20px">
                  <div class="alignLeft">
                      {{weekDay}}
                      <span *ngIf="!reports[weekDay + 'Frequency']">&#8593;</span>
                      <span *ngIf="reports[weekDay + 'Frequency']">&#8595;</span>
                  </div>
                </div>
              </th>
              <th>
                <div>Other</div>
              </th>
            </tr>
          </thead>
          <tbody *ngIf="reports">
            <tr *ngFor="let element of reports | filterTable: searchObj | orderBy: param:orderType | paginate: { itemsPerPage: 15, currentPage: p }; let i = index">
              <td class="fav" scope="col">
                <div>
                  <label for="{{element.ddm_rmp_post_report_id}}" class="custom-checkbox">
                    <input type="checkbox" [(ngModel)]="element.favorites" id="{{element.ddm_rmp_post_report_id}}"
                      (click)="checked(element.ddm_rmp_post_report_id,$event)" />
                    <i class="material-icons empty">star_border</i>
                    <i class="material-icons star">star</i>
                  </label>
                </div>
              </td>
              <td>
                <div>{{element.ddm_rmp_post_report_id}}</div>
              </td>
              <td>
                <div>{{element.ddm_rmp_status_date}}</div>
              </td>
              <td>
                <div>{{element.title}}</div>
              </td>
              <td class="ddm-report-name" (click)="goToReports(element.report_name,element.title)">
                <div>{{element.report_name}}</div>
              </td>
              <td>
                <div>{{element.frequency}}</div>
              </td>
              <td *ngFor="let weekDay of weekDays" >
                <div style="width: 20px">{{element[weekDay + 'Frequency']}}</div>
              </td>
              <td *ngIf="element.frequency_data || element.description">
                <div>
                    <span *ngFor="let subelement of element.frequency_data_filtered">{{subelement}} <br></span>
                    {{element.description}}
                </div>
              </td>
              <td *ngIf="!element.frequency_data && !element.description">

              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="padding-top: 0.7%;">
        <pagination-controls (pageChange)="p = $event"></pagination-controls>
      </div>

    </div>
  </div>
  <div class="main-tool-body" *ngIf="!reports">
    <mat-progress-spinner style="left:40%;top:40%;" mode="indeterminate"></mat-progress-spinner>
  </div>

  <div id="configReport" class="modal fade" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Configurable DDM Report</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body modal-comment-body">
          <div class="row config">
            <div class="col-sm-5">
              Request No.
            </div>
            <div class="col-sm-7">
              2018-2016
            </div>
          </div>

          <div class="row config">
            <div class="col-sm-5">
              Title:
            </div>
            <div class="col-sm-7">
              Order-to-Sale
            </div>
          </div>

          <div class="row config">
            <div class="col-sm-5">
              DDM Name:
            </div>
            <div class="col-sm-7">
              NC Allocation Group-Units in Stock
            </div>
          </div>

          <div class="row config">
            <div class="col-sm-5">
              Division(s):
            </div>
            <div class="col-sm-7">

              <ng-multiselect-dropdown class="drop-" [placeholder]="'Search for model'" [data]="dropdownList"
                [(ngModel)]="selectedItems" [settings]="dropdownSettings" (onSelect)="onItemSelect($event)"
                (onSelectAll)="onSelectAll($event)">
              </ng-multiselect-dropdown>

            </div>
          </div>

          <div class="row config-drop">
            <div class="col-sm-5">
              Allocation Groups(s):
            </div>
            <div class="col-sm-7">

              <ng-multiselect-dropdown class="drop-" [placeholder]="'Search for model'" [data]="dropdownList"
                [(ngModel)]="selectedItems" [settings]="dropdownSettings" (onSelect)="onItemSelect($event)"
                (onSelectAll)="onSelectAll($event)">
              </ng-multiselect-dropdown>

            </div>
          </div>

        </div>
        <div class="modal-footer">
          <div class="col-sm-6">
            <button type="button" class="btn btn-primary  footer-buttons">Create Report</button>
          </div>
          <div class="col-sm-6">
            <button type="button" class="btn btn-success">Save Settings</button>
          </div>
        </div>
      </div>

    </div>
  </div>
  <!-- <ngx-spinner [bdColor]="spinnerConfig.bdColor" [size]="spinnerConfig.size" [color]="spinnerConfig.color" [type]="spinnerConfig.type"></ngx-spinner> -->

  <div class="modal fade " id="helpModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header" style="justify-content: flex-start;">
          <img class="logo" src="/assets/OFT_Logo.jpg">
          <h5 class="modal-title help-title">Help</h5>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-9">
              <button class="btn btn-success save-text-ddm" (click)="content_edits()" *ngIf="editModes" style="margin-right:3%">Save</button>
              <button class="btn btn-danger save-text-ddm" (click)="edit_True()" *ngIf="editModes">Cancel</button>
            </div>
            <div class="col-3" style="padding-left:12%;">
              <button *ngIf="user_role == 'Admin'" id="edit_button" class="editButton" (click)="edit_True()" style="background-color:white;border: none;">
                <a data-toggle="tooltip" title="EDIT"><i id="ic" class="material-icons">mode_edit</i></a>
              </button>
            </div>
          </div>
          <!-- <div class="row ckEditor">
         <ckeditor [editor]="Editor" [(ngModel)]="namings" [disabled]="!editModes" (blur)="onChange($event)" style="width:100%; padding:1%;"></ckeditor>
       </div> -->
       <div  id="ckEditorHelp"></div>
     </div>
     <div class="modal-footer">
       <button type="button" id="modal_close_button" class="btn btn-secondary" data-dismiss="modal">Close</button>
     </div>
   </div>
 </div>
</div>
<app-ondemand-reports [requestNumber]="reportRequestNumberOD" [reportId]="reportIdOD" (odScheduleConfirmation)="startOnDemandScheduling($event)"></app-ondemand-reports>
<app-ondemand-config-reports [requestNumber]="reportRequestNumber" [title]="reportTitle"
  [name]="reportName" [reportId]="reportId" (odcScheduleConfirmation)="startOnDemandScheduling($event)"></app-ondemand-config-reports> 
<!-- [ynData]="confirmationValue" (odScheduleShow)="onDemandConfigurableScheduleShow($event)" -->
<!-- enhancement for odc single call would be,instead of emitting true,emit true,od/odc -->